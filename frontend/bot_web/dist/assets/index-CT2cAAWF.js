import{p as v,r as c,q as k,E as s}from"./index-B1JcSk7q.js";const S=v("user",()=>{const o=c(localStorage.getItem("token")||""),t=c(!1);async function u(m,i){var a,r,n,l;t.value=!0;try{const e=await k("/login",{username:m,password:i});return o.value=e.token,localStorage.setItem("token",o.value),s.success("登录成功"),!0}catch(e){o.value="",localStorage.removeItem("token");const f=((r=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:r.error)||((l=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:l.message)||(e==null?void 0:e.message)||"登录失败";throw s.error(f),e}finally{t.value=!1}}function g(){o.value="",localStorage.removeItem("token"),s.success("已退出登录")}return{token:o,loading:t,login:u,logout:g}});export{S as u};
