import{r as b,d as G,f as a,h as L,o as I,w as l,a as P,e,b as m,u as le,t as S,g as H,c as J,F as W,i as X,E as M,j as te,k as T,l as ae,_ as oe,n as q}from"./index-D2voZkgl.js";import{e as ne,f as h,h as ue,i as de,j as ie,k as se,l as pe,m as me,n as Z,o as re,p as _e,q as ve,t as fe,v as be,w as Ve,x as ce,y as ye,z as ge,A as xe,B as we,C as ke}from"./request-D3IGiyOk.js";const Ue={class:"flex justify-between mb-4"},Ce={__name:"AttackApiManager",setup(O){const $=b([]),g=b(!1),s=b({name:"",url:"",max_concurrency:1,description:"",status:"active"});async function r(){$.value=await ne()}async function z(){await de(s.value),M.success("添加成功"),g.value=!1,s.value={name:"",url:"",max_concurrency:1,description:"",status:"active"},r()}const w=b(!1),_=b({id:null,name:"",url:"",max_concurrency:1,description:"",status:"active"});function U(k){_.value={...k},w.value=!0}async function x(){const{id:k,...t}=_.value;await ie(k,t),M.success("修改成功"),w.value=!1,r()}const F=b(!1),o=b([]),i=b(null),f=b([]);async function u(k){i.value=k.id,F.value=!0,o.value=await h();const t=await ue(k.id);f.value=Array.isArray(t)?t.map(v=>v.id):[]}async function j(){await se(i.value,f.value),M.success("绑定成功"),F.value=!1,r()}G(r);const C=u;return(k,t)=>{const v=a("el-button"),n=a("el-table-column"),D=a("el-tag"),A=a("el-table"),E=a("el-input"),d=a("el-form-item"),c=a("el-input-number"),K=a("el-option"),N=a("el-select"),B=a("el-form"),Y=a("el-dialog"),V=a("el-card");return I(),L(V,null,{default:l(()=>[P("div",Ue,[t[19]||(t[19]=P("div",{class:"text-xl font-bold"},"API 管理",-1)),e(v,{type:"primary",onClick:t[0]||(t[0]=p=>g.value=!0)},{default:l(()=>t[18]||(t[18]=[m("新增 API")])),_:1,__:[18]})]),e(A,{data:$.value,border:"",onRowClick:le(C),height:"480px"},{default:l(()=>[e(n,{prop:"id",label:"ID",width:"60"}),e(n,{prop:"name",label:"API名称"}),e(n,{prop:"url",label:"地址"}),e(n,{prop:"max_concurrency",label:"最大并发",width:"120"}),e(n,{prop:"method_ids",label:"绑定方法",width:"180"}),e(n,{prop:"status",label:"状态",width:"100"},{default:l(({row:p})=>[e(D,{type:p.status==="active"?"success":"info"},{default:l(()=>[m(S(p.status),1)]),_:2},1032,["type"])]),_:1}),e(n,{prop:"description",label:"描述"}),e(n,{label:"操作",width:"140"},{default:l(({row:p})=>[e(v,{size:"small",onClick:H(Q=>u(p),["stop"])},{default:l(()=>t[20]||(t[20]=[m("绑定方法")])),_:2,__:[20]},1032,["onClick"]),e(v,{size:"small",type:"info",onClick:H(Q=>U(p),["stop"])},{default:l(()=>t[21]||(t[21]=[m("编辑")])),_:2,__:[21]},1032,["onClick"])]),_:1})]),_:1},8,["data","onRowClick"]),e(Y,{modelValue:g.value,"onUpdate:modelValue":t[7]||(t[7]=p=>g.value=p),title:"新增 API",width:"400px"},{footer:l(()=>[e(v,{onClick:t[6]||(t[6]=p=>g.value=!1)},{default:l(()=>t[22]||(t[22]=[m("取消")])),_:1,__:[22]}),e(v,{type:"primary",onClick:z},{default:l(()=>t[23]||(t[23]=[m("提交")])),_:1,__:[23]})]),default:l(()=>[e(B,{model:s.value,"label-width":"100px"},{default:l(()=>[e(d,{label:"名称"},{default:l(()=>[e(E,{modelValue:s.value.name,"onUpdate:modelValue":t[1]||(t[1]=p=>s.value.name=p)},null,8,["modelValue"])]),_:1}),e(d,{label:"地址"},{default:l(()=>[e(E,{modelValue:s.value.url,"onUpdate:modelValue":t[2]||(t[2]=p=>s.value.url=p)},null,8,["modelValue"])]),_:1}),e(d,{label:"最大并发"},{default:l(()=>[e(c,{modelValue:s.value.max_concurrency,"onUpdate:modelValue":t[3]||(t[3]=p=>s.value.max_concurrency=p),min:1},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:l(()=>[e(N,{modelValue:s.value.status,"onUpdate:modelValue":t[4]||(t[4]=p=>s.value.status=p),style:{width:"100px"}},{default:l(()=>[e(K,{label:"active",value:"active"}),e(K,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"描述"},{default:l(()=>[e(E,{modelValue:s.value.description,"onUpdate:modelValue":t[5]||(t[5]=p=>s.value.description=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(Y,{modelValue:w.value,"onUpdate:modelValue":t[14]||(t[14]=p=>w.value=p),title:"编辑 API",width:"400px"},{footer:l(()=>[e(v,{onClick:t[13]||(t[13]=p=>w.value=!1)},{default:l(()=>t[24]||(t[24]=[m("取消")])),_:1,__:[24]}),e(v,{type:"primary",onClick:x},{default:l(()=>t[25]||(t[25]=[m("保存")])),_:1,__:[25]})]),default:l(()=>[e(B,{model:_.value,"label-width":"100px"},{default:l(()=>[e(d,{label:"名称"},{default:l(()=>[e(E,{modelValue:_.value.name,"onUpdate:modelValue":t[8]||(t[8]=p=>_.value.name=p)},null,8,["modelValue"])]),_:1}),e(d,{label:"地址"},{default:l(()=>[e(E,{modelValue:_.value.url,"onUpdate:modelValue":t[9]||(t[9]=p=>_.value.url=p)},null,8,["modelValue"])]),_:1}),e(d,{label:"最大并发"},{default:l(()=>[e(c,{modelValue:_.value.max_concurrency,"onUpdate:modelValue":t[10]||(t[10]=p=>_.value.max_concurrency=p),min:1},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:l(()=>[e(N,{modelValue:_.value.status,"onUpdate:modelValue":t[11]||(t[11]=p=>_.value.status=p),style:{width:"100px"}},{default:l(()=>[e(K,{label:"active",value:"active"}),e(K,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"描述"},{default:l(()=>[e(E,{modelValue:_.value.description,"onUpdate:modelValue":t[12]||(t[12]=p=>_.value.description=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(Y,{modelValue:F.value,"onUpdate:modelValue":t[17]||(t[17]=p=>F.value=p),title:"API 绑定方法",width:"400px"},{footer:l(()=>[e(v,{onClick:t[16]||(t[16]=p=>F.value=!1)},{default:l(()=>t[26]||(t[26]=[m("取消")])),_:1,__:[26]}),e(v,{type:"primary",onClick:j},{default:l(()=>t[27]||(t[27]=[m("保存")])),_:1,__:[27]})]),default:l(()=>[e(B,{"label-width":"100px"},{default:l(()=>[e(d,{label:"可用方法"},{default:l(()=>[e(N,{modelValue:f.value,"onUpdate:modelValue":t[15]||(t[15]=p=>f.value=p),multiple:"",filterable:"",style:{width:"100%"},placeholder:"请选择要绑定的方法"},{default:l(()=>[(I(!0),J(W,null,X(o.value,p=>(I(),L(K,{key:p.id,label:`${p.display_name} (${p.name})`,value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},$e={class:"flex justify-between mb-4"},Ae={__name:"AttackMethodManager",setup(O){const $=b([]),g=b(!1),s=b({name:"",display_name:"",description:"",status:"active",slot_limit:1,point:0});async function r(){$.value=await h()}async function z(){await pe(s.value),M.success("添加成功"),g.value=!1,s.value={name:"",display_name:"",description:"",status:"active",slot_limit:1,point:0},r()}const w=b(!1),_=b({id:null,name:"",display_name:"",description:"",status:"active",slot_limit:1,point:0});function U(F){_.value={...F},w.value=!0}async function x(){const{id:F,...o}=_.value;await me(F,o),M.success("修改成功"),w.value=!1,r()}return G(r),(F,o)=>{const i=a("el-button"),f=a("el-table-column"),u=a("el-tag"),j=a("el-table"),C=a("el-input"),k=a("el-form-item"),t=a("el-input-number"),v=a("el-option"),n=a("el-select"),D=a("el-form"),A=a("el-dialog"),E=a("el-card");return I(),L(E,null,{default:l(()=>[P("div",$e,[o[18]||(o[18]=P("div",{class:"text-xl font-bold"},"方法管理",-1)),e(i,{type:"primary",onClick:o[0]||(o[0]=d=>g.value=!0)},{default:l(()=>o[17]||(o[17]=[m("新增方法")])),_:1,__:[17]})]),e(j,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(f,{prop:"id",label:"ID",width:"60"}),e(f,{prop:"name",label:"方法名"}),e(f,{prop:"display_name",label:"展示名"}),e(f,{prop:"slot_limit",label:"卡槽限制",width:"100"}),e(f,{prop:"point",label:"积分消耗",width:"100"}),e(f,{prop:"status",label:"状态",width:"100"},{default:l(({row:d})=>[e(u,{type:d.status==="active"?"success":"info"},{default:l(()=>[m(S(d.status),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"description",label:"描述"}),e(f,{label:"操作",width:"120"},{default:l(({row:d})=>[e(i,{size:"small",onClick:H(c=>U(d),["stop"])},{default:l(()=>o[19]||(o[19]=[m("编辑")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(A,{modelValue:g.value,"onUpdate:modelValue":o[8]||(o[8]=d=>g.value=d),title:"新增方法",width:"400px"},{footer:l(()=>[e(i,{onClick:o[7]||(o[7]=d=>g.value=!1)},{default:l(()=>o[20]||(o[20]=[m("取消")])),_:1,__:[20]}),e(i,{type:"primary",onClick:z},{default:l(()=>o[21]||(o[21]=[m("提交")])),_:1,__:[21]})]),default:l(()=>[e(D,{model:s.value,"label-width":"100px"},{default:l(()=>[e(k,{label:"方法名"},{default:l(()=>[e(C,{modelValue:s.value.name,"onUpdate:modelValue":o[1]||(o[1]=d=>s.value.name=d)},null,8,["modelValue"])]),_:1}),e(k,{label:"展示名"},{default:l(()=>[e(C,{modelValue:s.value.display_name,"onUpdate:modelValue":o[2]||(o[2]=d=>s.value.display_name=d)},null,8,["modelValue"])]),_:1}),e(k,{label:"卡槽限制"},{default:l(()=>[e(t,{modelValue:s.value.slot_limit,"onUpdate:modelValue":o[3]||(o[3]=d=>s.value.slot_limit=d),min:1},null,8,["modelValue"])]),_:1}),e(k,{label:"积分消耗"},{default:l(()=>[e(t,{modelValue:s.value.point,"onUpdate:modelValue":o[4]||(o[4]=d=>s.value.point=d),min:0},null,8,["modelValue"])]),_:1}),e(k,{label:"状态"},{default:l(()=>[e(n,{modelValue:s.value.status,"onUpdate:modelValue":o[5]||(o[5]=d=>s.value.status=d),style:{width:"100px"}},{default:l(()=>[e(v,{label:"active",value:"active"}),e(v,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"描述"},{default:l(()=>[e(C,{modelValue:s.value.description,"onUpdate:modelValue":o[6]||(o[6]=d=>s.value.description=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(A,{modelValue:w.value,"onUpdate:modelValue":o[16]||(o[16]=d=>w.value=d),title:"编辑方法",width:"400px"},{footer:l(()=>[e(i,{onClick:o[15]||(o[15]=d=>w.value=!1)},{default:l(()=>o[22]||(o[22]=[m("取消")])),_:1,__:[22]}),e(i,{type:"primary",onClick:x},{default:l(()=>o[23]||(o[23]=[m("保存")])),_:1,__:[23]})]),default:l(()=>[e(D,{model:_.value,"label-width":"100px"},{default:l(()=>[e(k,{label:"方法名"},{default:l(()=>[e(C,{modelValue:_.value.name,"onUpdate:modelValue":o[9]||(o[9]=d=>_.value.name=d)},null,8,["modelValue"])]),_:1}),e(k,{label:"展示名"},{default:l(()=>[e(C,{modelValue:_.value.display_name,"onUpdate:modelValue":o[10]||(o[10]=d=>_.value.display_name=d)},null,8,["modelValue"])]),_:1}),e(k,{label:"卡槽限制"},{default:l(()=>[e(t,{modelValue:_.value.slot_limit,"onUpdate:modelValue":o[11]||(o[11]=d=>_.value.slot_limit=d),min:1},null,8,["modelValue"])]),_:1}),e(k,{label:"积分消耗"},{default:l(()=>[e(t,{modelValue:_.value.point,"onUpdate:modelValue":o[12]||(o[12]=d=>_.value.point=d),min:0},null,8,["modelValue"])]),_:1}),e(k,{label:"状态"},{default:l(()=>[e(n,{modelValue:_.value.status,"onUpdate:modelValue":o[13]||(o[13]=d=>_.value.status=d),style:{width:"100px"}},{default:l(()=>[e(v,{label:"active",value:"active"}),e(v,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"描述"},{default:l(()=>[e(C,{modelValue:_.value.description,"onUpdate:modelValue":o[14]||(o[14]=d=>_.value.description=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},Pe={class:"flex justify-between mb-4"},De={__name:"PlanManager",setup(O){const $=b([]),g=b(!1),s=b(!1),r=b({id:null,name:"",price:0,period:30,max_time:3600,max_concurrency:1,description:"",status:"active"});async function z(){$.value=await Z()}async function w(){await ve(r.value),M.success("添加成功"),g.value=!1,F(),z()}function _(o){r.value={...o},s.value=!0,g.value=!0}async function U(){const{id:o,...i}=r.value;await _e(o,i),M.success("修改成功"),g.value=!1,s.value=!1,F(),z()}async function x(o){await re(o.id),M.success("删除成功"),z()}function F(){r.value={id:null,name:"",price:0,period:30,max_time:3600,max_concurrency:1,description:"",status:"active"}}return G(z),(o,i)=>{const f=a("el-button"),u=a("el-table-column"),j=a("el-tag"),C=a("el-table"),k=a("el-input"),t=a("el-form-item"),v=a("el-input-number"),n=a("el-option"),D=a("el-select"),A=a("el-form"),E=a("el-dialog"),d=a("el-card");return I(),J("div",null,[e(d,null,{default:l(()=>[P("div",Pe,[i[12]||(i[12]=P("div",{class:"text-xl font-bold"},"套餐列表",-1)),e(f,{type:"primary",onClick:i[0]||(i[0]=c=>g.value=!0)},{default:l(()=>i[11]||(i[11]=[m("新增套餐")])),_:1,__:[11]})]),e(C,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(u,{prop:"id",label:"ID",width:"60"}),e(u,{prop:"name",label:"名称"}),e(u,{prop:"price",label:"价格(元)",width:"100"}),e(u,{prop:"period",label:"有效期(天)",width:"100"}),e(u,{prop:"max_time",label:"最大时长(秒)",width:"120"}),e(u,{prop:"max_concurrency",label:"最大并发",width:"100"}),e(u,{prop:"status",label:"状态",width:"100"},{default:l(({row:c})=>[e(j,{type:c.status==="active"?"success":"info"},{default:l(()=>[m(S(c.status),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"description",label:"描述"}),e(u,{label:"操作",width:"140"},{default:l(({row:c})=>[e(f,{size:"small",onClick:H(K=>_(c),["stop"])},{default:l(()=>i[13]||(i[13]=[m("编辑")])),_:2,__:[13]},1032,["onClick"]),e(f,{size:"small",type:"danger",onClick:H(K=>x(c),["stop"])},{default:l(()=>i[14]||(i[14]=[m("删除")])),_:2,__:[14]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(E,{modelValue:g.value,"onUpdate:modelValue":i[10]||(i[10]=c=>g.value=c),title:s.value?"编辑套餐":"新增套餐",width:"400px"},{footer:l(()=>[e(f,{onClick:i[8]||(i[8]=c=>g.value=!1)},{default:l(()=>i[15]||(i[15]=[m("取消")])),_:1,__:[15]}),e(f,{type:"primary",onClick:i[9]||(i[9]=c=>s.value?U():w())},{default:l(()=>[m(S(s.value?"保存":"提交"),1)]),_:1})]),default:l(()=>[e(A,{model:r.value,"label-width":"110px"},{default:l(()=>[e(t,{label:"名称"},{default:l(()=>[e(k,{modelValue:r.value.name,"onUpdate:modelValue":i[1]||(i[1]=c=>r.value.name=c)},null,8,["modelValue"])]),_:1}),e(t,{label:"价格"},{default:l(()=>[e(v,{modelValue:r.value.price,"onUpdate:modelValue":i[2]||(i[2]=c=>r.value.price=c),min:0,precision:2},null,8,["modelValue"])]),_:1}),e(t,{label:"有效期(天)"},{default:l(()=>[e(v,{modelValue:r.value.period,"onUpdate:modelValue":i[3]||(i[3]=c=>r.value.period=c),min:1},null,8,["modelValue"])]),_:1}),e(t,{label:"最大时长(秒)"},{default:l(()=>[e(v,{modelValue:r.value.max_time,"onUpdate:modelValue":i[4]||(i[4]=c=>r.value.max_time=c),min:1},null,8,["modelValue"])]),_:1}),e(t,{label:"最大并发"},{default:l(()=>[e(v,{modelValue:r.value.max_concurrency,"onUpdate:modelValue":i[5]||(i[5]=c=>r.value.max_concurrency=c),min:1},null,8,["modelValue"])]),_:1}),e(t,{label:"状态"},{default:l(()=>[e(D,{modelValue:r.value.status,"onUpdate:modelValue":i[6]||(i[6]=c=>r.value.status=c),style:{width:"100px"}},{default:l(()=>[e(n,{label:"active",value:"active"}),e(n,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(t,{label:"描述"},{default:l(()=>[e(k,{modelValue:r.value.description,"onUpdate:modelValue":i[7]||(i[7]=c=>r.value.description=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})])}}},Ie={class:"flex justify-between mb-4"},Me={class:"select-all"},ze={class:"flex justify-end my-4"},Fe={__name:"CardKeyManager",setup(O){const $=b([]),g=b(1),s=b(20),r=b(0);async function z(f=1){g.value=f;const u=await fe({page:g.value,pageSize:s.value});$.value=u.list||[],r.value=u.total||0}G(()=>z());const w=b([]);async function _(){w.value.length===0&&(w.value=await Z()||[])}const U=b(!1),x=b({type:"plan",plan_id:null,point:null,count:10,prefix:"",length:16});te([U,()=>x.value.type],([f,u])=>{f&&u==="plan"&&_()});async function F(){if(x.value.type==="plan"&&!x.value.plan_id)return M.error("请选择套餐");if(x.value.type==="point"&&!x.value.point)return M.error("请输入积分数");const f=await Ve(x.value);M.success(`成功生成${f.keys.length}张卡密`),U.value=!1,z()}function o(f){navigator.clipboard.writeText(f),M.success("已复制到剪贴板")}async function i(){await be(),M.success("已导出全部卡密")}return(f,u)=>{const j=a("el-button"),C=a("el-table-column"),k=a("el-tag"),t=a("el-table"),v=a("el-pagination"),n=a("el-radio"),D=a("el-radio-group"),A=a("el-form-item"),E=a("el-option"),d=a("el-select"),c=a("el-input-number"),K=a("el-input"),N=a("el-form"),B=a("el-dialog"),Y=a("el-card");return I(),L(Y,null,{default:l(()=>[P("div",Ie,[u[10]||(u[10]=P("div",{class:"text-xl font-bold"},"卡密管理",-1)),e(j,{type:"primary",onClick:u[0]||(u[0]=V=>U.value=!0)},{default:l(()=>u[9]||(u[9]=[m("批量生成卡密")])),_:1,__:[9]})]),e(t,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(C,{prop:"id",label:"ID",width:"70"}),e(C,{prop:"code",label:"卡密",width:"300"},{default:l(({row:V})=>[P("span",Me,S(V.code),1),e(j,{icon:"el-icon-document-copy",size:"small",type:"text",onClick:H(p=>o(V.code),["stop"])},{default:l(()=>u[11]||(u[11]=[m("复制")])),_:2,__:[11]},1032,["onClick"])]),_:1}),e(C,{prop:"type",label:"类型",width:"80"},{default:l(({row:V})=>[e(k,{type:V.type==="plan"?"primary":"success"},{default:l(()=>[m(S(V.type==="plan"?"套餐":"积分"),1)]),_:2},1032,["type"])]),_:1}),e(C,{prop:"prefix",label:"前缀",width:"80"}),e(C,{prop:"length",label:"位数",width:"70"}),f.showPlan?(I(),L(C,{key:0,prop:"plan_id",label:"套餐ID",width:"80"})):T("",!0),f.showPoint?(I(),L(C,{key:1,prop:"point",label:"积分",width:"80"})):T("",!0),e(C,{prop:"status",label:"状态",width:"90"},{default:l(({row:V})=>[e(k,{type:V.status==="unused"?"info":"success"},{default:l(()=>[m(S(V.status==="unused"?"未使用":"已使用"),1)]),_:2},1032,["type"])]),_:1}),e(C,{prop:"used_by",label:"使用者ID",width:"100"}),e(C,{prop:"used_time",label:"使用时间",width:"160"}),e(C,{prop:"createdAt",label:"生成时间",width:"160"})]),_:1},8,["data"]),P("div",ze,[e(v,{layout:"prev, pager, next, jumper",total:r.value,"page-size":s.value,"current-page":g.value,onCurrentChange:z},null,8,["total","page-size","current-page"]),e(j,{onClick:i,class:"ml-4"},{default:l(()=>u[12]||(u[12]=[m("导出全部")])),_:1,__:[12]})]),e(B,{modelValue:U.value,"onUpdate:modelValue":u[8]||(u[8]=V=>U.value=V),title:"批量生成卡密",width:"420px"},{footer:l(()=>[e(j,{onClick:u[7]||(u[7]=V=>U.value=!1)},{default:l(()=>u[15]||(u[15]=[m("取消")])),_:1,__:[15]}),e(j,{type:"primary",onClick:F},{default:l(()=>u[16]||(u[16]=[m("生成")])),_:1,__:[16]})]),default:l(()=>[e(N,{model:x.value,"label-width":"100px"},{default:l(()=>[e(A,{label:"类型"},{default:l(()=>[e(D,{modelValue:x.value.type,"onUpdate:modelValue":u[1]||(u[1]=V=>x.value.type=V)},{default:l(()=>[e(n,{label:"plan"},{default:l(()=>u[13]||(u[13]=[m("套餐卡密")])),_:1,__:[13]}),e(n,{label:"point"},{default:l(()=>u[14]||(u[14]=[m("积分卡密")])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),x.value.type==="plan"?(I(),L(A,{key:0,label:"套餐"},{default:l(()=>[e(d,{modelValue:x.value.plan_id,"onUpdate:modelValue":u[2]||(u[2]=V=>x.value.plan_id=V),placeholder:"请选择套餐",filterable:"",style:{width:"100%"}},{default:l(()=>[(I(!0),J(W,null,X(w.value,V=>(I(),L(E,{key:V.id,label:`${V.name}（¥${V.price}，${V.period}天）`,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),x.value.type==="point"?(I(),L(A,{key:1,label:"积分数"},{default:l(()=>[e(c,{modelValue:x.value.point,"onUpdate:modelValue":u[3]||(u[3]=V=>x.value.point=V),min:1},null,8,["modelValue"])]),_:1})):T("",!0),e(A,{label:"数量"},{default:l(()=>[e(c,{modelValue:x.value.count,"onUpdate:modelValue":u[4]||(u[4]=V=>x.value.count=V),min:1,max:500},null,8,["modelValue"])]),_:1}),e(A,{label:"前缀"},{default:l(()=>[e(K,{modelValue:x.value.prefix,"onUpdate:modelValue":u[5]||(u[5]=V=>x.value.prefix=V),placeholder:"如VIP-"},null,8,["modelValue"])]),_:1}),e(A,{label:"位数"},{default:l(()=>[e(c,{modelValue:x.value.length,"onUpdate:modelValue":u[6]||(u[6]=V=>x.value.length=V),min:8,max:40},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},je={class:"flex justify-between mb-4"},Ee={class:"flex justify-end my-4"},Ke={__name:"UserManager",setup(O){const $=b([]),g=b(1),s=b(20),r=b(0),z=b([]);async function w(v=1){g.value=v;const n=await ce({page:g.value,pageSize:s.value});$.value=n.list||[],r.value=n.total||0}G(()=>{w(),Z().then(v=>z.value=v)});const _=b(!1),U=b({});function x(v){U.value={...v},_.value=!0}async function F(){await we(U.value.id,U.value),M.success("修改成功"),_.value=!1,w(g.value)}async function o(v){await ye(v.id),M.success("已封禁"),w(g.value)}async function i(v){await ge(v.id),M.success("已解封"),w(g.value)}const f=b(!1),u=b(null),j=b(0);function C(v){u.value=v,j.value=0,f.value=!0}async function k(){await ke(u.value.id,j.value),M.success("操作成功"),f.value=!1,w(g.value)}async function t(v){ae.confirm("确认删除该用户？","提示",{type:"warning"}).then(async()=>{await xe(v.id),M.success("删除成功"),w(g.value)}).catch(()=>{})}return(v,n)=>{const D=a("el-button"),A=a("el-table-column"),E=a("el-tag"),d=a("el-table"),c=a("el-pagination"),K=a("el-option"),N=a("el-select"),B=a("el-form-item"),Y=a("el-date-picker"),V=a("el-input-number"),p=a("el-form"),Q=a("el-dialog"),ee=a("el-card");return I(),L(ee,null,{default:l(()=>[P("div",je,[n[10]||(n[10]=P("div",{class:"text-xl font-bold"},"用户管理",-1)),e(D,{type:"primary",onClick:w},{default:l(()=>n[9]||(n[9]=[m("刷新")])),_:1,__:[9]})]),e(d,{data:$.value,border:"",height:"480px",onRowDblclick:x},{default:l(()=>[e(A,{prop:"id",label:"ID",width:"70"}),e(A,{prop:"tg_uid",label:"TG UID"}),e(A,{prop:"plan_id",label:"套餐ID",width:"90"}),e(A,{prop:"expire_time",label:"到期",width:"170"}),e(A,{prop:"point",label:"积分",width:"90"}),e(A,{prop:"status",label:"状态",width:"90"},{default:l(({row:y})=>[e(E,{type:y.status==="active"?"success":y.status==="banned"?"danger":"info"},{default:l(()=>[m(S(y.status==="active"?"正常":y.status==="banned"?"已封禁":"过期"),1)]),_:2},1032,["type"])]),_:1}),e(A,{prop:"reg_time",label:"注册时间",width:"170"}),e(A,{label:"操作",width:"340"},{default:l(({row:y})=>[y.status!=="banned"?(I(),L(D,{key:0,size:"small",onClick:R=>o(y)},{default:l(()=>n[11]||(n[11]=[m("封禁")])),_:2,__:[11]},1032,["onClick"])):T("",!0),y.status==="banned"?(I(),L(D,{key:1,size:"small",type:"success",onClick:R=>i(y)},{default:l(()=>n[12]||(n[12]=[m("解封")])),_:2,__:[12]},1032,["onClick"])):T("",!0),e(D,{size:"small",type:"primary",onClick:R=>x(y)},{default:l(()=>n[13]||(n[13]=[m("编辑")])),_:2,__:[13]},1032,["onClick"]),e(D,{size:"small",type:"warning",onClick:R=>C(y)},{default:l(()=>n[14]||(n[14]=[m("加/减积分")])),_:2,__:[14]},1032,["onClick"]),e(D,{size:"small",type:"danger",onClick:R=>t(y)},{default:l(()=>n[15]||(n[15]=[m("删除")])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),P("div",Ee,[e(c,{layout:"prev, pager, next, jumper",total:r.value,"page-size":s.value,"current-page":g.value,onCurrentChange:w},null,8,["total","page-size","current-page"])]),e(Q,{modelValue:_.value,"onUpdate:modelValue":n[5]||(n[5]=y=>_.value=y),title:"编辑用户",width:"420px"},{footer:l(()=>[e(D,{onClick:n[4]||(n[4]=y=>_.value=!1)},{default:l(()=>n[16]||(n[16]=[m("取消")])),_:1,__:[16]}),e(D,{type:"primary",onClick:F},{default:l(()=>n[17]||(n[17]=[m("保存")])),_:1,__:[17]})]),default:l(()=>[e(p,{model:U.value,"label-width":"100px"},{default:l(()=>[e(B,{label:"状态"},{default:l(()=>[e(N,{modelValue:U.value.status,"onUpdate:modelValue":n[0]||(n[0]=y=>U.value.status=y),style:{width:"120px"}},{default:l(()=>[e(K,{label:"正常",value:"active"}),e(K,{label:"封禁",value:"banned"}),e(K,{label:"过期",value:"expired"})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"套餐"},{default:l(()=>[e(N,{modelValue:U.value.plan_id,"onUpdate:modelValue":n[1]||(n[1]=y=>U.value.plan_id=y),style:{width:"180px"},filterable:"",clearable:""},{default:l(()=>[(I(!0),J(W,null,X(z.value,y=>(I(),L(K,{key:y.id,label:`${y.name}（${y.period}天）`,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"到期时间"},{default:l(()=>[e(Y,{modelValue:U.value.expire_time,"onUpdate:modelValue":n[2]||(n[2]=y=>U.value.expire_time=y),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(B,{label:"积分"},{default:l(()=>[e(V,{modelValue:U.value.point,"onUpdate:modelValue":n[3]||(n[3]=y=>U.value.point=y),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(Q,{modelValue:f.value,"onUpdate:modelValue":n[8]||(n[8]=y=>f.value=y),title:"加/减积分",width:"320px"},{footer:l(()=>[e(D,{onClick:n[7]||(n[7]=y=>f.value=!1)},{default:l(()=>n[18]||(n[18]=[m("取消")])),_:1,__:[18]}),e(D,{type:"primary",onClick:k},{default:l(()=>n[19]||(n[19]=[m("提交")])),_:1,__:[19]})]),default:l(()=>{var y;return[P("div",null,"当前积分："+S((y=u.value)==null?void 0:y.point),1),e(V,{modelValue:j.value,"onUpdate:modelValue":n[6]||(n[6]=R=>j.value=R),min:-99999,max:99999,style:{margin:"16px 0"}},null,8,["modelValue"])]}),_:1},8,["modelValue"])]),_:1})}}},Le={__name:"manager",setup(O){const $=b("api");return(g,s)=>{const r=a("el-tab-pane"),z=a("el-tabs");return I(),J("div",null,[s[1]||(s[1]=P("div",{class:"flex items-center gap-3 mb-2"},[P("i",{class:"el-icon-data-board text-blue-500 text-3xl"}),P("span",{class:"text-3xl font-bold"},"Manager")],-1)),e(z,{modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=w=>$.value=w),class:"custom-el-tabs mb-6"},{default:l(()=>[e(r,{name:"api"},{label:l(()=>[P("span",{class:q(["tab-label",$.value==="api"?"tab-group-active":"tab-group"])},"API 管理",2)]),default:l(()=>[e(Ce)]),_:1}),e(r,{name:"method"},{label:l(()=>[P("span",{class:q(["tab-label",$.value==="method"?"tab-group-active":"tab-group"])},"方法管理",2)]),default:l(()=>[e(Ae)]),_:1}),e(r,{name:"plan"},{label:l(()=>[P("span",{class:q(["tab-label",$.value==="plan"?"tab-plan-active":"tab-plan"])},"套餐管理",2)]),default:l(()=>[e(De)]),_:1}),e(r,{name:"card"},{label:l(()=>[P("span",{class:q(["tab-label",$.value==="card"?"tab-card-active":"tab-card"])},"卡密管理",2)]),default:l(()=>[e(Fe)]),_:1}),e(r,{name:"user"},{label:l(()=>[P("span",{class:q(["tab-label",$.value==="user"?"tab-user-active":"tab-user"])},"用户管理",2)]),default:l(()=>[e(Ke)]),_:1})]),_:1},8,["modelValue"])])}}},Ne=oe(Le,[["__scopeId","data-v-1cd901dc"]]);export{Ne as default};
