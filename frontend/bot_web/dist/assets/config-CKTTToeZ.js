import{r as w,t as I,c as N,d as r,a as l,h as d,w as t,b as i,o as A,e as C,v as H,E as p}from"./index-B1JcSk7q.js";import{g as M,a as R,b as G,u as K,s as P,r as Z,c as j,d as F}from"./request-yOfsC26L.js";const q={class:"flex justify-between items-center"},Q={__name:"config",setup(z){const n=w({BOTTOKEN:"",BOT_ADMIN:"",AUTHORIZED_GROUPS:[]}),_=w(""),v=w(!1);async function m(){try{const a=await G();v.value=!!(a!=null&&a.running)}catch{v.value=!1}}async function y(){const a=await M();n.value=a||{},_.value=(n.value.AUTHORIZED_GROUPS||[]).join(","),await m()}async function T(){n.value.AUTHORIZED_GROUPS=_.value.split(",").map(a=>a.trim()).filter(Boolean),await K(n.value),p.success("✅ 配置已保存"),await m()}async function O(){await P(),p.success("🤖 已尝试启动 Bot"),await m()}async function S(){await j(),p.warning("⛔ 已尝试停止 Bot"),await m()}async function k(){await Z(),p.info("♻️ 正在重启 Bot"),await m()}const u=w({mode:"daily",point_mode:"fixed",point_amount:"10"});async function B(){const a=await R();a&&(u.value=a)}async function U(){await F(u.value),p.success("✅ 签到配置已保存")}return I(()=>{y(),B()}),(a,e)=>{const D=i("el-tag"),g=i("el-input"),s=i("el-form-item"),f=i("el-button"),E=i("el-divider"),c=i("el-form"),V=i("el-card"),b=i("el-option"),x=i("el-select");return A(),N("div",null,[e[17]||(e[17]=r("div",{class:"text-3xl font-bold mb-6 flex items-center gap-3"},[r("i",{class:"el-icon-data-board text-blue-500"}),d(" Config ")],-1)),l(V,{class:"mb-8"},{header:t(()=>[r("div",q,[e[8]||(e[8]=r("span",{class:"text-lg font-semibold"},"⚙️ 机器人配置管理",-1)),l(D,{type:v.value?"success":"danger",effect:"dark"},{default:t(()=>[d(H(v.value?"运行中":"未启动"),1)]),_:1},8,["type"])])]),default:t(()=>[l(c,{model:n.value,"label-width":"130px",class:"w-full",onSubmit:e[3]||(e[3]=C(()=>{},["prevent"]))},{default:t(()=>[l(s,{label:"Bot Token"},{default:t(()=>[l(g,{modelValue:n.value.BOTTOKEN,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.BOTTOKEN=o),placeholder:"请输入 Bot Token"},null,8,["modelValue"])]),_:1}),l(s,{label:"管理员 ID"},{default:t(()=>[l(g,{modelValue:n.value.BOT_ADMIN,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.BOT_ADMIN=o),placeholder:"你的 Telegram ID"},null,8,["modelValue"])]),_:1}),l(s,{label:"授权群组 ID"},{default:t(()=>[l(g,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=o=>_.value=o),placeholder:"多个群组用英文逗号分隔，如：-100123,-100456 (如果不填则允许全部)"},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(f,{type:"primary",onClick:T},{default:t(()=>e[9]||(e[9]=[d("💾 保存配置")])),_:1,__:[9]}),l(f,{onClick:y},{default:t(()=>e[10]||(e[10]=[d("🔄 重新加载")])),_:1,__:[10]})]),_:1}),l(E),l(s,{label:"机器人控制"},{default:t(()=>[l(f,{type:"success",onClick:O},{default:t(()=>e[11]||(e[11]=[d("▶️ 启动")])),_:1,__:[11]}),l(f,{type:"warning",onClick:k},{default:t(()=>e[12]||(e[12]=[d("♻️ 重启")])),_:1,__:[12]}),l(f,{type:"danger",onClick:S},{default:t(()=>e[13]||(e[13]=[d("⛔ 停止")])),_:1,__:[13]})]),_:1})]),_:1},8,["model"])]),_:1}),l(V,null,{header:t(()=>e[14]||(e[14]=[r("span",{class:"text-lg font-semibold"},"📝 签到管理",-1)])),default:t(()=>[l(c,{model:u.value,"label-width":"130px",class:"w-full",onSubmit:e[7]||(e[7]=C(()=>{},["prevent"]))},{default:t(()=>[l(s,{label:"刷新机制"},{default:t(()=>[l(x,{modelValue:u.value.mode,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value.mode=o),style:{width:"200px"}},{default:t(()=>[l(b,{label:"每天0点重置 (daily)",value:"daily"}),l(b,{label:"每24小时重置 (24h)",value:"24h"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"积分获取方式"},{default:t(()=>[l(x,{modelValue:u.value.point_mode,"onUpdate:modelValue":e[5]||(e[5]=o=>u.value.point_mode=o),style:{width:"200px"}},{default:t(()=>[l(b,{label:"固定积分",value:"fixed"}),l(b,{label:"随机积分",value:"random"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"积分值"},{default:t(()=>[l(g,{modelValue:u.value.point_amount,"onUpdate:modelValue":e[6]||(e[6]=o=>u.value.point_amount=o),style:{width:"200px"},placeholder:"如10或15-30"},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(f,{type:"primary",onClick:U},{default:t(()=>e[15]||(e[15]=[d("💾 保存签到配置")])),_:1,__:[15]}),l(f,{onClick:B},{default:t(()=>e[16]||(e[16]=[d("🔄 重新加载")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])]),_:1})])}}};export{Q as default};
