import{r as b,t as G,b as n,i as j,o as I,w as l,d as M,a as e,h as r,f as le,v as S,e as H,c as J,F as Z,x as h,E as z,y as te,z as T,A as ae,_ as oe,B as q}from"./index-B1JcSk7q.js";import{e as X,f as ne,h as ue,i as de,j as ie,k as se,l as pe,m as me,n as ee,o as re,p as _e,q as ve,t as fe,v as be,w as ce,x as Ve,y as ye,z as ge,A as xe,B as we,C as ke}from"./request-yOfsC26L.js";const Ue={class:"flex justify-between mb-4"},Ce={__name:"AttackApiManager",setup(O){const $=b([]),x=b([]),_=b(!1),d=b({name:"",url:"",max_concurrency:1,description:"",status:"active"});async function D(){x.value=await X();const k=await ne(),t={};x.value.forEach(a=>{t[a.id]=a.name}),k.forEach(a=>{let y=a.method_ids;typeof y=="string"&&(y=y.split(",").map(Number)),Array.isArray(y)||(y=[]),a.method_names=y.map(C=>t[C]).filter(Boolean).join(", ")}),$.value=k}async function U(){await de(d.value),z.success("添加成功"),_.value=!1,d.value={name:"",url:"",max_concurrency:1,description:"",status:"active"},D()}const g=b(!1),v=b({id:null,name:"",url:"",max_concurrency:1,description:"",status:"active"});function w(k){v.value={...k},g.value=!0}async function E(){const{id:k,...t}=v.value;await ie(k,t),z.success("修改成功"),g.value=!1,D()}const o=b(!1),i=b([]),c=b(null),u=b([]);async function F(k){c.value=k.id,o.value=!0,i.value=await X();const t=await ue(k.id);u.value=Array.isArray(t)?t.map(a=>a.id):[]}async function A(){await se(c.value,u.value),z.success("绑定成功"),o.value=!1,D()}G(D);const P=F;return(k,t)=>{const a=n("el-button"),y=n("el-table-column"),C=n("el-tag"),N=n("el-table"),s=n("el-input"),m=n("el-form-item"),B=n("el-input-number"),L=n("el-option"),K=n("el-select"),Y=n("el-form"),f=n("el-dialog"),Q=n("el-card");return I(),j(Q,null,{default:l(()=>[M("div",Ue,[t[19]||(t[19]=M("div",{class:"text-xl font-bold"},"API 管理",-1)),e(a,{type:"primary",onClick:t[0]||(t[0]=p=>_.value=!0)},{default:l(()=>t[18]||(t[18]=[r("新增 API")])),_:1,__:[18]})]),e(N,{data:$.value,border:"",onRowClick:le(P),height:"480px"},{default:l(()=>[e(y,{prop:"id",label:"ID",width:"60"}),e(y,{prop:"name",label:"API名称"}),e(y,{prop:"url",label:"地址"}),e(y,{prop:"max_concurrency",label:"最大并发",width:"120"}),e(y,{prop:"method_names",label:"绑定方法",width:"180"}),e(y,{prop:"status",label:"状态",width:"100"},{default:l(({row:p})=>[e(C,{type:p.status==="active"?"success":"info"},{default:l(()=>[r(S(p.status),1)]),_:2},1032,["type"])]),_:1}),e(y,{prop:"description",label:"描述"}),e(y,{label:"操作",width:"140"},{default:l(({row:p})=>[e(a,{size:"small",onClick:H(W=>F(p),["stop"])},{default:l(()=>t[20]||(t[20]=[r("绑定方法")])),_:2,__:[20]},1032,["onClick"]),e(a,{size:"small",type:"info",onClick:H(W=>w(p),["stop"])},{default:l(()=>t[21]||(t[21]=[r("编辑")])),_:2,__:[21]},1032,["onClick"])]),_:1})]),_:1},8,["data","onRowClick"]),e(f,{modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=p=>_.value=p),title:"新增 API",width:"400px"},{footer:l(()=>[e(a,{onClick:t[6]||(t[6]=p=>_.value=!1)},{default:l(()=>t[22]||(t[22]=[r("取消")])),_:1,__:[22]}),e(a,{type:"primary",onClick:U},{default:l(()=>t[23]||(t[23]=[r("提交")])),_:1,__:[23]})]),default:l(()=>[e(Y,{model:d.value,"label-width":"100px"},{default:l(()=>[e(m,{label:"名称"},{default:l(()=>[e(s,{modelValue:d.value.name,"onUpdate:modelValue":t[1]||(t[1]=p=>d.value.name=p)},null,8,["modelValue"])]),_:1}),e(m,{label:"地址"},{default:l(()=>[e(s,{modelValue:d.value.url,"onUpdate:modelValue":t[2]||(t[2]=p=>d.value.url=p)},null,8,["modelValue"])]),_:1}),e(m,{label:"最大并发"},{default:l(()=>[e(B,{modelValue:d.value.max_concurrency,"onUpdate:modelValue":t[3]||(t[3]=p=>d.value.max_concurrency=p),min:1},null,8,["modelValue"])]),_:1}),e(m,{label:"状态"},{default:l(()=>[e(K,{modelValue:d.value.status,"onUpdate:modelValue":t[4]||(t[4]=p=>d.value.status=p),style:{width:"100px"}},{default:l(()=>[e(L,{label:"active",value:"active"}),e(L,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"描述"},{default:l(()=>[e(s,{modelValue:d.value.description,"onUpdate:modelValue":t[5]||(t[5]=p=>d.value.description=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(f,{modelValue:g.value,"onUpdate:modelValue":t[14]||(t[14]=p=>g.value=p),title:"编辑 API",width:"400px"},{footer:l(()=>[e(a,{onClick:t[13]||(t[13]=p=>g.value=!1)},{default:l(()=>t[24]||(t[24]=[r("取消")])),_:1,__:[24]}),e(a,{type:"primary",onClick:E},{default:l(()=>t[25]||(t[25]=[r("保存")])),_:1,__:[25]})]),default:l(()=>[e(Y,{model:v.value,"label-width":"100px"},{default:l(()=>[e(m,{label:"名称"},{default:l(()=>[e(s,{modelValue:v.value.name,"onUpdate:modelValue":t[8]||(t[8]=p=>v.value.name=p)},null,8,["modelValue"])]),_:1}),e(m,{label:"地址"},{default:l(()=>[e(s,{modelValue:v.value.url,"onUpdate:modelValue":t[9]||(t[9]=p=>v.value.url=p)},null,8,["modelValue"])]),_:1}),e(m,{label:"最大并发"},{default:l(()=>[e(B,{modelValue:v.value.max_concurrency,"onUpdate:modelValue":t[10]||(t[10]=p=>v.value.max_concurrency=p),min:1},null,8,["modelValue"])]),_:1}),e(m,{label:"状态"},{default:l(()=>[e(K,{modelValue:v.value.status,"onUpdate:modelValue":t[11]||(t[11]=p=>v.value.status=p),style:{width:"100px"}},{default:l(()=>[e(L,{label:"active",value:"active"}),e(L,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"描述"},{default:l(()=>[e(s,{modelValue:v.value.description,"onUpdate:modelValue":t[12]||(t[12]=p=>v.value.description=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(f,{modelValue:o.value,"onUpdate:modelValue":t[17]||(t[17]=p=>o.value=p),title:"API 绑定方法",width:"400px"},{footer:l(()=>[e(a,{onClick:t[16]||(t[16]=p=>o.value=!1)},{default:l(()=>t[26]||(t[26]=[r("取消")])),_:1,__:[26]}),e(a,{type:"primary",onClick:A},{default:l(()=>t[27]||(t[27]=[r("保存")])),_:1,__:[27]})]),default:l(()=>[e(Y,{"label-width":"100px"},{default:l(()=>[e(m,{label:"可用方法"},{default:l(()=>[e(K,{modelValue:u.value,"onUpdate:modelValue":t[15]||(t[15]=p=>u.value=p),multiple:"",filterable:"",style:{width:"100%"},placeholder:"请选择要绑定的方法"},{default:l(()=>[(I(!0),J(Z,null,h(i.value,p=>(I(),j(L,{key:p.id,label:p.name,value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},$e={class:"flex justify-between mb-4"},Ae={__name:"AttackMethodManager",setup(O){const $=b([]),x=b(!1),_=b({name:"",description:"",status:"active",slot_limit:1,point:0,limit_time:0});async function d(){$.value=await X()}async function D(){await pe(_.value),z.success("添加成功"),x.value=!1,_.value={name:"",description:"",status:"active",slot_limit:1,point:0,limit_time:0},d()}const U=b(!1),g=b({id:null,name:"",description:"",status:"active",slot_limit:1,point:0,limit_time:0});function v(E){g.value={...E},U.value=!0}async function w(){const{id:E,...o}=g.value;await me(E,o),z.success("修改成功"),U.value=!1,d()}return G(d),(E,o)=>{const i=n("el-button"),c=n("el-table-column"),u=n("el-tag"),F=n("el-table"),A=n("el-input"),P=n("el-form-item"),k=n("el-input-number"),t=n("el-option"),a=n("el-select"),y=n("el-form"),C=n("el-dialog"),N=n("el-card");return I(),j(N,null,{default:l(()=>[M("div",$e,[o[18]||(o[18]=M("div",{class:"text-xl font-bold"},"方法管理",-1)),e(i,{type:"primary",onClick:o[0]||(o[0]=s=>x.value=!0)},{default:l(()=>o[17]||(o[17]=[r("新增方法")])),_:1,__:[17]})]),e(F,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(c,{prop:"id",label:"ID",width:"60"}),e(c,{prop:"name",label:"方法名"}),e(c,{prop:"slot_limit",label:"卡槽限制",width:"100"}),e(c,{prop:"point",label:"积分消耗",width:"100"}),e(c,{prop:"limit_time",label:"最大时长(秒)",width:"120"}),e(c,{prop:"status",label:"状态",width:"100"},{default:l(({row:s})=>[e(u,{type:s.status==="active"?"success":"info"},{default:l(()=>[r(S(s.status),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"description",label:"描述"}),e(c,{label:"操作",width:"120"},{default:l(({row:s})=>[e(i,{size:"small",onClick:H(m=>v(s),["stop"])},{default:l(()=>o[19]||(o[19]=[r("编辑")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(C,{modelValue:x.value,"onUpdate:modelValue":o[8]||(o[8]=s=>x.value=s),title:"新增方法",width:"400px"},{footer:l(()=>[e(i,{onClick:o[7]||(o[7]=s=>x.value=!1)},{default:l(()=>o[20]||(o[20]=[r("取消")])),_:1,__:[20]}),e(i,{type:"primary",onClick:D},{default:l(()=>o[21]||(o[21]=[r("提交")])),_:1,__:[21]})]),default:l(()=>[e(y,{model:_.value,"label-width":"100px"},{default:l(()=>[e(P,{label:"方法名"},{default:l(()=>[e(A,{modelValue:_.value.name,"onUpdate:modelValue":o[1]||(o[1]=s=>_.value.name=s)},null,8,["modelValue"])]),_:1}),e(P,{label:"卡槽限制"},{default:l(()=>[e(k,{modelValue:_.value.slot_limit,"onUpdate:modelValue":o[2]||(o[2]=s=>_.value.slot_limit=s),min:1},null,8,["modelValue"])]),_:1}),e(P,{label:"积分消耗"},{default:l(()=>[e(k,{modelValue:_.value.point,"onUpdate:modelValue":o[3]||(o[3]=s=>_.value.point=s),min:0},null,8,["modelValue"])]),_:1}),e(P,{label:"最大时长(秒)"},{default:l(()=>[e(k,{modelValue:_.value.limit_time,"onUpdate:modelValue":o[4]||(o[4]=s=>_.value.limit_time=s),min:0,step:10},null,8,["modelValue"])]),_:1}),e(P,{label:"状态"},{default:l(()=>[e(a,{modelValue:_.value.status,"onUpdate:modelValue":o[5]||(o[5]=s=>_.value.status=s),style:{width:"100px"}},{default:l(()=>[e(t,{label:"active",value:"active"}),e(t,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"描述"},{default:l(()=>[e(A,{modelValue:_.value.description,"onUpdate:modelValue":o[6]||(o[6]=s=>_.value.description=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(C,{modelValue:U.value,"onUpdate:modelValue":o[16]||(o[16]=s=>U.value=s),title:"编辑方法",width:"400px"},{footer:l(()=>[e(i,{onClick:o[15]||(o[15]=s=>U.value=!1)},{default:l(()=>o[22]||(o[22]=[r("取消")])),_:1,__:[22]}),e(i,{type:"primary",onClick:w},{default:l(()=>o[23]||(o[23]=[r("保存")])),_:1,__:[23]})]),default:l(()=>[e(y,{model:g.value,"label-width":"100px"},{default:l(()=>[e(P,{label:"方法名"},{default:l(()=>[e(A,{modelValue:g.value.name,"onUpdate:modelValue":o[9]||(o[9]=s=>g.value.name=s)},null,8,["modelValue"])]),_:1}),e(P,{label:"卡槽限制"},{default:l(()=>[e(k,{modelValue:g.value.slot_limit,"onUpdate:modelValue":o[10]||(o[10]=s=>g.value.slot_limit=s),min:1},null,8,["modelValue"])]),_:1}),e(P,{label:"积分消耗"},{default:l(()=>[e(k,{modelValue:g.value.point,"onUpdate:modelValue":o[11]||(o[11]=s=>g.value.point=s),min:0},null,8,["modelValue"])]),_:1}),e(P,{label:"最大时长(秒)"},{default:l(()=>[e(k,{modelValue:g.value.limit_time,"onUpdate:modelValue":o[12]||(o[12]=s=>g.value.limit_time=s),min:0,step:10},null,8,["modelValue"])]),_:1}),e(P,{label:"状态"},{default:l(()=>[e(a,{modelValue:g.value.status,"onUpdate:modelValue":o[13]||(o[13]=s=>g.value.status=s),style:{width:"100px"}},{default:l(()=>[e(t,{label:"active",value:"active"}),e(t,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"描述"},{default:l(()=>[e(A,{modelValue:g.value.description,"onUpdate:modelValue":o[14]||(o[14]=s=>g.value.description=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},Pe={class:"flex justify-between mb-4"},Me={__name:"PlanManager",setup(O){const $=b([]),x=b(!1),_=b(!1),d=b({id:null,name:"",price:0,period:30,max_time:3600,max_concurrency:1,description:"",status:"active"});async function D(){$.value=await ee()}async function U(){await ve(d.value),z.success("添加成功"),x.value=!1,E(),D()}function g(o){d.value={...o},_.value=!0,x.value=!0}async function v(){const{id:o,...i}=d.value;await _e(o,i),z.success("修改成功"),x.value=!1,_.value=!1,E(),D()}async function w(o){await re(o.id),z.success("删除成功"),D()}function E(){d.value={id:null,name:"",price:0,period:30,max_time:3600,max_concurrency:1,description:"",status:"active"}}return G(D),(o,i)=>{const c=n("el-button"),u=n("el-table-column"),F=n("el-tag"),A=n("el-table"),P=n("el-input"),k=n("el-form-item"),t=n("el-input-number"),a=n("el-option"),y=n("el-select"),C=n("el-form"),N=n("el-dialog"),s=n("el-card");return I(),J("div",null,[e(s,null,{default:l(()=>[M("div",Pe,[i[12]||(i[12]=M("div",{class:"text-xl font-bold"},"套餐列表",-1)),e(c,{type:"primary",onClick:i[0]||(i[0]=m=>x.value=!0)},{default:l(()=>i[11]||(i[11]=[r("新增套餐")])),_:1,__:[11]})]),e(A,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(u,{prop:"id",label:"ID",width:"60"}),e(u,{prop:"name",label:"名称"}),e(u,{prop:"price",label:"价格(元)",width:"100"}),e(u,{prop:"period",label:"有效期(天)",width:"100"}),e(u,{prop:"max_time",label:"最大时长(秒)",width:"120"}),e(u,{prop:"max_concurrency",label:"最大并发",width:"100"}),e(u,{prop:"status",label:"状态",width:"100"},{default:l(({row:m})=>[e(F,{type:m.status==="active"?"success":"info"},{default:l(()=>[r(S(m.status),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"description",label:"描述"}),e(u,{label:"操作",width:"140"},{default:l(({row:m})=>[e(c,{size:"small",onClick:H(B=>g(m),["stop"])},{default:l(()=>i[13]||(i[13]=[r("编辑")])),_:2,__:[13]},1032,["onClick"]),e(c,{size:"small",type:"danger",onClick:H(B=>w(m),["stop"])},{default:l(()=>i[14]||(i[14]=[r("删除")])),_:2,__:[14]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(N,{modelValue:x.value,"onUpdate:modelValue":i[10]||(i[10]=m=>x.value=m),title:_.value?"编辑套餐":"新增套餐",width:"400px"},{footer:l(()=>[e(c,{onClick:i[8]||(i[8]=m=>x.value=!1)},{default:l(()=>i[15]||(i[15]=[r("取消")])),_:1,__:[15]}),e(c,{type:"primary",onClick:i[9]||(i[9]=m=>_.value?v():U())},{default:l(()=>[r(S(_.value?"保存":"提交"),1)]),_:1})]),default:l(()=>[e(C,{model:d.value,"label-width":"110px"},{default:l(()=>[e(k,{label:"名称"},{default:l(()=>[e(P,{modelValue:d.value.name,"onUpdate:modelValue":i[1]||(i[1]=m=>d.value.name=m)},null,8,["modelValue"])]),_:1}),e(k,{label:"价格"},{default:l(()=>[e(t,{modelValue:d.value.price,"onUpdate:modelValue":i[2]||(i[2]=m=>d.value.price=m),min:0,precision:2},null,8,["modelValue"])]),_:1}),e(k,{label:"有效期(天)"},{default:l(()=>[e(t,{modelValue:d.value.period,"onUpdate:modelValue":i[3]||(i[3]=m=>d.value.period=m),min:1},null,8,["modelValue"])]),_:1}),e(k,{label:"最大时长(秒)"},{default:l(()=>[e(t,{modelValue:d.value.max_time,"onUpdate:modelValue":i[4]||(i[4]=m=>d.value.max_time=m),min:1},null,8,["modelValue"])]),_:1}),e(k,{label:"最大并发"},{default:l(()=>[e(t,{modelValue:d.value.max_concurrency,"onUpdate:modelValue":i[5]||(i[5]=m=>d.value.max_concurrency=m),min:1},null,8,["modelValue"])]),_:1}),e(k,{label:"状态"},{default:l(()=>[e(y,{modelValue:d.value.status,"onUpdate:modelValue":i[6]||(i[6]=m=>d.value.status=m),style:{width:"100px"}},{default:l(()=>[e(a,{label:"active",value:"active"}),e(a,{label:"inactive",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"描述"},{default:l(()=>[e(P,{modelValue:d.value.description,"onUpdate:modelValue":i[7]||(i[7]=m=>d.value.description=m)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})])}}},De={class:"flex justify-between mb-4"},Ie={class:"select-all"},ze={class:"flex justify-end my-4"},Fe={__name:"CardKeyManager",setup(O){const $=b([]),x=b(1),_=b(20),d=b(0);async function D(c=1){x.value=c;const u=await fe({page:x.value,pageSize:_.value});$.value=u.list||[],d.value=u.total||0}G(()=>D());const U=b([]);async function g(){U.value.length===0&&(U.value=await ee()||[])}const v=b(!1),w=b({type:"plan",plan_id:null,point:null,count:10,prefix:"",length:16});te([v,()=>w.value.type],([c,u])=>{c&&u==="plan"&&g()});async function E(){if(w.value.type==="plan"&&!w.value.plan_id)return z.error("请选择套餐");if(w.value.type==="point"&&!w.value.point)return z.error("请输入积分数");const c=await ce(w.value);z.success(`成功生成${c.keys.length}张卡密`),v.value=!1,D()}function o(c){navigator.clipboard.writeText(c),z.success("已复制到剪贴板")}async function i(){await be(),z.success("已导出全部卡密")}return(c,u)=>{const F=n("el-button"),A=n("el-table-column"),P=n("el-tag"),k=n("el-table"),t=n("el-pagination"),a=n("el-radio"),y=n("el-radio-group"),C=n("el-form-item"),N=n("el-option"),s=n("el-select"),m=n("el-input-number"),B=n("el-input"),L=n("el-form"),K=n("el-dialog"),Y=n("el-card");return I(),j(Y,null,{default:l(()=>[M("div",De,[u[10]||(u[10]=M("div",{class:"text-xl font-bold"},"卡密管理",-1)),e(F,{type:"primary",onClick:u[0]||(u[0]=f=>v.value=!0)},{default:l(()=>u[9]||(u[9]=[r("批量生成卡密")])),_:1,__:[9]})]),e(k,{data:$.value,border:"",height:"480px"},{default:l(()=>[e(A,{prop:"id",label:"ID",width:"70"}),e(A,{prop:"code",label:"卡密",width:"300"},{default:l(({row:f})=>[M("span",Ie,S(f.code),1),e(F,{icon:"el-icon-document-copy",size:"small",type:"text",onClick:H(Q=>o(f.code),["stop"])},{default:l(()=>u[11]||(u[11]=[r("复制")])),_:2,__:[11]},1032,["onClick"])]),_:1}),e(A,{prop:"type",label:"类型",width:"80"},{default:l(({row:f})=>[e(P,{type:f.type==="plan"?"primary":"success"},{default:l(()=>[r(S(f.type==="plan"?"套餐":"积分"),1)]),_:2},1032,["type"])]),_:1}),e(A,{prop:"prefix",label:"前缀",width:"80"}),e(A,{prop:"length",label:"位数",width:"70"}),c.showPlan?(I(),j(A,{key:0,prop:"plan_id",label:"套餐ID",width:"80"})):T("",!0),c.showPoint?(I(),j(A,{key:1,prop:"point",label:"积分",width:"80"})):T("",!0),e(A,{prop:"status",label:"状态",width:"90"},{default:l(({row:f})=>[e(P,{type:f.status==="unused"?"info":"success"},{default:l(()=>[r(S(f.status==="unused"?"未使用":"已使用"),1)]),_:2},1032,["type"])]),_:1}),e(A,{prop:"used_by",label:"使用者ID",width:"100"}),e(A,{prop:"used_time",label:"使用时间",width:"160"}),e(A,{prop:"createdAt",label:"生成时间",width:"160"})]),_:1},8,["data"]),M("div",ze,[e(t,{layout:"prev, pager, next, jumper",total:d.value,"page-size":_.value,"current-page":x.value,onCurrentChange:D},null,8,["total","page-size","current-page"]),e(F,{onClick:i,class:"ml-4"},{default:l(()=>u[12]||(u[12]=[r("导出全部")])),_:1,__:[12]})]),e(K,{modelValue:v.value,"onUpdate:modelValue":u[8]||(u[8]=f=>v.value=f),title:"批量生成卡密",width:"420px"},{footer:l(()=>[e(F,{onClick:u[7]||(u[7]=f=>v.value=!1)},{default:l(()=>u[15]||(u[15]=[r("取消")])),_:1,__:[15]}),e(F,{type:"primary",onClick:E},{default:l(()=>u[16]||(u[16]=[r("生成")])),_:1,__:[16]})]),default:l(()=>[e(L,{model:w.value,"label-width":"100px"},{default:l(()=>[e(C,{label:"类型"},{default:l(()=>[e(y,{modelValue:w.value.type,"onUpdate:modelValue":u[1]||(u[1]=f=>w.value.type=f)},{default:l(()=>[e(a,{label:"plan"},{default:l(()=>u[13]||(u[13]=[r("套餐卡密")])),_:1,__:[13]}),e(a,{label:"point"},{default:l(()=>u[14]||(u[14]=[r("积分卡密")])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),w.value.type==="plan"?(I(),j(C,{key:0,label:"套餐"},{default:l(()=>[e(s,{modelValue:w.value.plan_id,"onUpdate:modelValue":u[2]||(u[2]=f=>w.value.plan_id=f),placeholder:"请选择套餐",filterable:"",style:{width:"100%"}},{default:l(()=>[(I(!0),J(Z,null,h(U.value,f=>(I(),j(N,{key:f.id,label:`${f.name}（¥${f.price}，${f.period}天）`,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),w.value.type==="point"?(I(),j(C,{key:1,label:"积分数"},{default:l(()=>[e(m,{modelValue:w.value.point,"onUpdate:modelValue":u[3]||(u[3]=f=>w.value.point=f),min:1},null,8,["modelValue"])]),_:1})):T("",!0),e(C,{label:"数量"},{default:l(()=>[e(m,{modelValue:w.value.count,"onUpdate:modelValue":u[4]||(u[4]=f=>w.value.count=f),min:1,max:500},null,8,["modelValue"])]),_:1}),e(C,{label:"前缀"},{default:l(()=>[e(B,{modelValue:w.value.prefix,"onUpdate:modelValue":u[5]||(u[5]=f=>w.value.prefix=f),placeholder:"如VIP-"},null,8,["modelValue"])]),_:1}),e(C,{label:"位数"},{default:l(()=>[e(m,{modelValue:w.value.length,"onUpdate:modelValue":u[6]||(u[6]=f=>w.value.length=f),min:8,max:40},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},Ee={class:"flex justify-between mb-4"},je={class:"flex justify-end my-4"},Be={__name:"UserManager",setup(O){const $=b([]),x=b(1),_=b(20),d=b(0),D=b([]);async function U(t=1){x.value=t;const a=await Ve({page:x.value,pageSize:_.value});$.value=a.list||[],d.value=a.total||0}G(()=>{U(),ee().then(t=>D.value=t)});const g=b(!1),v=b({});function w(t){v.value={...t},g.value=!0}async function E(){await we(v.value.id,v.value),z.success("修改成功"),g.value=!1,U(x.value)}async function o(t){await ye(t.id),z.success("已封禁"),U(x.value)}async function i(t){await ge(t.id),z.success("已解封"),U(x.value)}const c=b(!1),u=b(null),F=b(0);function A(t){u.value=t,F.value=0,c.value=!0}async function P(){await ke(u.value.id,F.value),z.success("操作成功"),c.value=!1,U(x.value)}async function k(t){ae.confirm("确认删除该用户？","提示",{type:"warning"}).then(async()=>{await xe(t.id),z.success("删除成功"),U(x.value)}).catch(()=>{})}return(t,a)=>{const y=n("el-button"),C=n("el-table-column"),N=n("el-tag"),s=n("el-table"),m=n("el-pagination"),B=n("el-option"),L=n("el-select"),K=n("el-form-item"),Y=n("el-date-picker"),f=n("el-input-number"),Q=n("el-form"),p=n("el-dialog"),W=n("el-card");return I(),j(W,null,{default:l(()=>[M("div",Ee,[a[10]||(a[10]=M("div",{class:"text-xl font-bold"},"用户管理",-1)),e(y,{type:"primary",onClick:U},{default:l(()=>a[9]||(a[9]=[r("刷新")])),_:1,__:[9]})]),e(s,{data:$.value,border:"",height:"480px",onRowDblclick:w},{default:l(()=>[e(C,{prop:"id",label:"ID",width:"70"}),e(C,{prop:"tg_uid",label:"TG UID"}),e(C,{prop:"plan_id",label:"套餐ID",width:"90"}),e(C,{prop:"expire_time",label:"到期",width:"170"}),e(C,{prop:"point",label:"积分",width:"90"}),e(C,{prop:"status",label:"状态",width:"90"},{default:l(({row:V})=>[e(N,{type:V.status==="active"?"success":V.status==="banned"?"danger":"info"},{default:l(()=>[r(S(V.status==="active"?"正常":V.status==="banned"?"已封禁":"过期"),1)]),_:2},1032,["type"])]),_:1}),e(C,{prop:"reg_time",label:"注册时间",width:"170"}),e(C,{label:"操作",width:"340"},{default:l(({row:V})=>[V.status!=="banned"?(I(),j(y,{key:0,size:"small",onClick:R=>o(V)},{default:l(()=>a[11]||(a[11]=[r("封禁")])),_:2,__:[11]},1032,["onClick"])):T("",!0),V.status==="banned"?(I(),j(y,{key:1,size:"small",type:"success",onClick:R=>i(V)},{default:l(()=>a[12]||(a[12]=[r("解封")])),_:2,__:[12]},1032,["onClick"])):T("",!0),e(y,{size:"small",type:"primary",onClick:R=>w(V)},{default:l(()=>a[13]||(a[13]=[r("编辑")])),_:2,__:[13]},1032,["onClick"]),e(y,{size:"small",type:"warning",onClick:R=>A(V)},{default:l(()=>a[14]||(a[14]=[r("加/减积分")])),_:2,__:[14]},1032,["onClick"]),e(y,{size:"small",type:"danger",onClick:R=>k(V)},{default:l(()=>a[15]||(a[15]=[r("删除")])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),M("div",je,[e(m,{layout:"prev, pager, next, jumper",total:d.value,"page-size":_.value,"current-page":x.value,onCurrentChange:U},null,8,["total","page-size","current-page"])]),e(p,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=V=>g.value=V),title:"编辑用户",width:"420px"},{footer:l(()=>[e(y,{onClick:a[4]||(a[4]=V=>g.value=!1)},{default:l(()=>a[16]||(a[16]=[r("取消")])),_:1,__:[16]}),e(y,{type:"primary",onClick:E},{default:l(()=>a[17]||(a[17]=[r("保存")])),_:1,__:[17]})]),default:l(()=>[e(Q,{model:v.value,"label-width":"100px"},{default:l(()=>[e(K,{label:"状态"},{default:l(()=>[e(L,{modelValue:v.value.status,"onUpdate:modelValue":a[0]||(a[0]=V=>v.value.status=V),style:{width:"120px"}},{default:l(()=>[e(B,{label:"正常",value:"active"}),e(B,{label:"封禁",value:"banned"}),e(B,{label:"过期",value:"expired"})]),_:1},8,["modelValue"])]),_:1}),e(K,{label:"套餐"},{default:l(()=>[e(L,{modelValue:v.value.plan_id,"onUpdate:modelValue":a[1]||(a[1]=V=>v.value.plan_id=V),style:{width:"180px"},filterable:"",clearable:""},{default:l(()=>[(I(!0),J(Z,null,h(D.value,V=>(I(),j(B,{key:V.id,label:`${V.name}（${V.period}天）`,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(K,{label:"到期时间"},{default:l(()=>[e(Y,{modelValue:v.value.expire_time,"onUpdate:modelValue":a[2]||(a[2]=V=>v.value.expire_time=V),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(K,{label:"积分"},{default:l(()=>[e(f,{modelValue:v.value.point,"onUpdate:modelValue":a[3]||(a[3]=V=>v.value.point=V),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(p,{modelValue:c.value,"onUpdate:modelValue":a[8]||(a[8]=V=>c.value=V),title:"加/减积分",width:"320px"},{footer:l(()=>[e(y,{onClick:a[7]||(a[7]=V=>c.value=!1)},{default:l(()=>a[18]||(a[18]=[r("取消")])),_:1,__:[18]}),e(y,{type:"primary",onClick:P},{default:l(()=>a[19]||(a[19]=[r("提交")])),_:1,__:[19]})]),default:l(()=>{var V;return[M("div",null,"当前积分："+S((V=u.value)==null?void 0:V.point),1),e(f,{modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=R=>F.value=R),min:-99999,max:99999,style:{margin:"16px 0"}},null,8,["modelValue"])]}),_:1},8,["modelValue"])]),_:1})}}},Le={__name:"manager",setup(O){const $=b("api");return(x,_)=>{const d=n("el-tab-pane"),D=n("el-tabs");return I(),J("div",null,[_[1]||(_[1]=M("div",{class:"flex items-center gap-3 mb-2"},[M("i",{class:"el-icon-data-board text-blue-500 text-3xl"}),M("span",{class:"text-3xl font-bold"},"Manager")],-1)),e(D,{modelValue:$.value,"onUpdate:modelValue":_[0]||(_[0]=U=>$.value=U),class:"custom-el-tabs mb-6"},{default:l(()=>[e(d,{name:"api"},{label:l(()=>[M("span",{class:q(["tab-label",$.value==="api"?"tab-group-active":"tab-group"])},"API 管理",2)]),default:l(()=>[e(Ce)]),_:1}),e(d,{name:"method"},{label:l(()=>[M("span",{class:q(["tab-label",$.value==="method"?"tab-group-active":"tab-group"])},"方法管理",2)]),default:l(()=>[e(Ae)]),_:1}),e(d,{name:"plan"},{label:l(()=>[M("span",{class:q(["tab-label",$.value==="plan"?"tab-plan-active":"tab-plan"])},"套餐管理",2)]),default:l(()=>[e(Me)]),_:1}),e(d,{name:"card"},{label:l(()=>[M("span",{class:q(["tab-label",$.value==="card"?"tab-card-active":"tab-card"])},"卡密管理",2)]),default:l(()=>[e(Fe)]),_:1}),e(d,{name:"user"},{label:l(()=>[M("span",{class:q(["tab-label",$.value==="user"?"tab-user-active":"tab-user"])},"用户管理",2)]),default:l(()=>[e(Be)]),_:1})]),_:1},8,["modelValue"])])}}},Se=oe(Le,[["__scopeId","data-v-1cd901dc"]]);export{Se as default};
